%!TEX program = xelate
\input{structure.tex}
\usepackage{epstopdf}
\usepackage{graphics}
\usepackage{subfig}
\usepackage{listings}
\lstset{
  breaklines=true,
  xleftmargin=25pt,
  xrightmargin=25pt,
  aboveskip=0pt,
  belowskip=10pt,
  basicstyle=\ttfamily,
  showstringspaces=false,
  frame=ltrb,
  tabsize=4,
  numbers=left,
  numberstyle=\small,
  numbersep=8pt,
  morekeywords={*, factorial, sum, erlang},
}
\DeclareGraphicsExtensions{.eps,.ps,.jpg,.bmp}

\begin{document}

\title{Numerical Analysis \\ Assignment 1}
\date{\today}
\author{Chuan Lu}

\maketitle

\problem{1}{Problem 1.1, Page 43}
\solution{(a)}{
In fact, 
$$
\frac{1}{n} n\inf_{a\le x\le b} f(x) \le \frac{1}{n}\sum_{i=1}^{n}f(i) \le \frac{1}{n}n\sup_{a\le x\le b}f(x).
$$
So according to intermediate theorem, there exists $\zeta\in[a, b]$, $S = f(\zeta)$.
}
\solution{(b)}{
The proposition now becomes as this:
$$
S = \sum_{i=1}^{n}w_if(x_i) = f(\zeta)\sum_{i=1}^{n}w_i,
$$
for some $\zeta\in [a, b]$. The proof is just the same as (a).
}

\problem{2}{Promblem 1.2, Page 43}
\solution{(a)}{
Denote $f(x) = e^{x}$, then according to the mean value theorem,
$$
|e^x-e^z| = f'(\xi)|x-z|,
$$
where $\xi \le 0$, so $|e^x-e^z| \le |x-z|$.
}
\solution{(b)}{
Denote $f(x) = \tan(x)$, then $|\tan(x)-\tan(x)| = f'(\xi)|x-z| \le |x-z|$.
}
\solution{(c)}{
Denote $f(x) = x^p$, then $x^p-y^p = f'(\xi)(x-y), ~\xi\in[x, y]$. Thus $py^{p-1}(x-y) \le x^p-y^p \le px^{p-1}(x-y).$
}
% \problem{2}{Problem 1.2, Page 43}
% \solution{(a)}{
% I believe without the condition that $x, z$ are in the neighbourhood of $0$, it can not be derived by only Taylor series. \\
% Fix $z < 0$, let $f(t) = |e^(t+z) - e^z|-|t|$.
% When $t > 0$, $f'(t) = e^(t+z)-1$. So $f(t)$ reaches it's maximum when $t=-z$, and $\max f(t) = 0$. It is similar when $t < 0$. With the arbitrariness of $z$, we can derive the inequality.
% }
% \solution{(b)}{
% Similar with (a), we choose to use other methods.
% Fix $z$, denote $t = x-z$, let $f = |\tan(z+t)-\tan(z)|-|t|$. When $t > 0$, we have $f'(t) = \frac{1}{\cos^2(z+t)}-1 >= 0$, so $\min f = 0$. Similarly when $t < 0$, we have $\min f = 0$. So $|x-z| \le |\tan(x)-\tan(z)|$. 
% }
% \solution{(c)}{
% Denote $\xi = x-y$, then
% $$
% x^p-y^p = (y+\xi)^p-y^p = py^{p-1}\xi + R, ~R > 0.
% $$
% and we have
% $$
% x^p-y^p = x^p-(x-\xi)^p = px^{p-1}\xi + R, ~R < 0.
% $$
% So the inequality stands.
% }

\problem{3}{Problem 1.4, Page 44}
\solution{Proof}{
According to Integral Mean Value theorem, 
$$
\int_{0}^h x^2(h-x)^2g(x)dx = g(\xi)\int_{0}^h x^2(h-x)^2dx = \frac{1}{30}h^5g(\xi),
$$
for some $\xi\in [0, h]$.
}

\problem{4}{Problem 1.5, Page 44}
\solution{(a)}{
Since 
$$
\left(\int_0^x e^{-t^2}dt\right)' = e^{-x^2},
$$
and 
$$
\begin{aligned}
e^{-x^2} &= 1+(-x^2)+\frac{(-x^2)^2}{2!}+\frac{(-x^2)^3}{3!}+\cdots+\frac{(-x^2)^n}{n!}+\frac{e^{-\theta x^2}}{(n+1)!}(-x^2)^{n+1} \\ 
&= 1-x^2+\frac{x^4}{2!}-\frac{x^6}{3!}+\cdots+\frac{(-1)^nx^{2n}}{n!}+\frac{(-1)^{n+1}e^{-\theta x^2}}{(n+1)!}x^{2n+2}
\end{aligned}
$$
We have 
$$
\frac{1}{x}\int_0^x e^{-t^2}dt = \frac{1}{1\cdot0!} - \frac{1}{3\cdot 1!}x^2 + \frac{1}{5\cdot 2!}x^4 + \cdots + (-1)^{n}\frac{1}{(2n+1)\cdot n!}x^{2n} + R_{2n+1},
$$
where 
$$
|R_{2n+1}| \le \frac{x^{2n+1}}{(2n+2)(n+1)!}.
$$
}
\solution{(b)}{
Since
$$
\left(\sin^{-1}(x)\right)' = \frac{1}{\sqrt{1-x^2}},
$$
and
$$
\begin{aligned}
\frac{1}{\sqrt{1-x^2}} &= 1- \frac{1}{2}(-x^2)+\frac{1\cdot 3}{2\cdot 4}(-x^2)^2+\cdots + (-1)^n\frac{(2n-1)!!}{2n!!}(-x^2)^n + (-1)^{n+1}\frac{(2n+1)!!}{(2n+2)!!}\frac{(-x^2)^{n+1}}{(1-\theta x^2)^{n+\frac{3}{2}}} \\
&= 1 + \frac{1}{2}x^2+\frac{1\cdot 3}{2\cdot 4}x^4+\cdots + \frac{(2n-1)!!}{2n!!}x^{2n} + \frac{(2n+1)!!}{(2n+2)!!}\frac{x^{2(n+1)}}{(1-\theta x^2)^{n+\frac{3}{2}}}
\end{aligned}
$$
We have
$$
\sin^{-1}(x) = x + \frac{1}{3\cdot 2}x^3 + \frac{1\cdot 3}{5\cdot 2\cdot 4}x^5 +\cdots + \frac{(2n-1)!!}{(2n+1)(2n)!!}x^{2n+1} + R_{2n+2},
$$
where 
$$
|R_{2n+2}| \le \frac{(2n+1)!!}{(2n+2)(2n+2)!!}x^{2n+2}
$$
}
\solution{(c)}{
Since
$$
\left(\int_0^x \frac{\tan^{-1}t}{t}dt\right)' = \frac{\tan^{-1}x}{x}, ~\left(\tan^{-1}x\right)' = \frac{1}{1+x^2}
$$
and 
$$
\frac{1}{1+x^2} = 1-x^2+x^4-x^6+\cdots+(-1)^{n}x^{2n}+ (-1)^{n+1}\frac{x^{2n+2}}{(1+\theta x)^{2n+4}},
$$
We have
$$
\tan^{-1}x = x - \frac{1}{3}x^3 + \frac{1}{5}x^5 - \cdots + (-1)^n\frac{x^{2n+1}}{2n+1} + (-1)^{n+1}\frac{x^{2n+3}}{2n+3} + (-1)^{n+2}\frac{x^{2n+5}}{2n+5} + R_{n+3},
$$
$$
R_{n+3} = (-1)^{n+3}\frac{x^{2n+7}}{(1+\theta x)^{2n+7}}
$$
So
$$
\frac{1}{x}\int_0^x\frac{\tan^{-1}t}{t}dt = 1-\frac{1}{3^2}x^2+\frac{1}{5^2}x^4-\cdots+(-1)^n\frac{x^{2n}}{(2n+1)^2}+R_{n+1},
$$
and
$$
|R_{n+1}| \le \frac{x^{2n+2}}{(2n+3)(2n+4)}.
$$
}
\solution{(d)}{  
$$
\cos(x)+\sin(x) = 1+x-\frac{x^2}{2!}-\frac{x^3}{3!}+\cdots+(-1)^n\frac{x^{2n}}{(2n)!}+(-1)^n\frac{x^{2n+1}}{(2n+1)!}+R_{2n},
$$
$$
\begin{aligned}
R_{2n} &= \frac{x^{2n+2}}{(2n+2)!}cos(\theta_1 x+(n+1)\pi) + \frac{x^{2n+3}}{(2n+3)!}\sin\left(\theta_2 x+\frac{2n+3}{2}\pi\right) \\
&\le \frac{x^{2n+2}}{(2n+2)!}+\frac{x^{2n+3}}{(2n+3)!}.
\end{aligned}
$$
}
\solution{(e)}{
$$
\log(1-x) = \frac{\ln(1-x)}{\ln 10} = \frac{1}{\ln 10}\left(-x-\frac{x^2}{2}-\frac{x^3}{3}-\cdots-\frac{x^n}{n} + R_{n+1}\right),
$$
and
$$
|R_{n+1}| \le \frac{|x|^{n+2}}{n+2}.
$$
}
\solution{(f)}{
$$
\begin{aligned}
\log\left(\frac{1+x}{1-x}\right) &= \frac{1}{\ln 10}(\ln(1+x)-\ln(1-x))\\
&= \frac{1}{\ln 10}\left(x-\frac{x^2}{2}+\frac{x^3}{3}-\cdots+(-1)^{n-1}\frac{x^n}{n} - (-x-\frac{x^2}{2}-\frac{x^3}{3}-\cdots-\frac{x^n}{n})+R_{n+1} \right) \\
&= \frac{2}{\ln 10}\left(x+\frac{x^3}{3}+\cdots+\frac{x^{2n+1}}{2n+1} +R_{n+1}\right),
\end{aligned}
$$
and 
$$
|R_{n+1}| \le \frac{|x|^{2n+2}}{2n+2}
$$
}
\end{document}