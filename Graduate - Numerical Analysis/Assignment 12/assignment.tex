%!TEX program = xelate
\input{structure.tex}
\usepackage{epstopdf}
\usepackage{graphics}
\usepackage{subfig}
\usepackage{listings}
\lstset{
  breaklines=true,
  xleftmargin=25pt,
  xrightmargin=25pt,
  aboveskip=0pt,
  belowskip=10pt,
  basicstyle=\ttfamily,
  showstringspaces=false,
  frame=ltrb,
  tabsize=4,
  numbers=left,
  numberstyle=\small,
  numbersep=8pt,
  morekeywords={*, factorial, sum, erlang},
  keywordstyle=\color{blue!70}, commentstyle=\color{red!50!green!50!blue!50},
}
\DeclareGraphicsExtensions{.eps,.ps,.jpg,.bmp}

\begin{document}

\title{Numerical Analysis \\ Assignment 11}
\date{\today}
\author{Chuan Lu}

\maketitle

\problem{1}{Problem 5.1}
\problem{2}{Problem 5.2}
\problem{3}{Problem 5.3}
\solution{Sol}{
The code and result of these three problems are listed below. 
}
\lstinputlisting[language = MATLAB]{trapezoidal.m}
\lstinputlisting[language = MATLAB]{simpson.m}
\lstinputlisting[language = MATLAB]{corrected_trapezoidal.m}
\lstinputlisting[language = MATLAB]{convergence.m}
\lstinputlisting[language = MATLAB]{prob1.m}

\begin{lstlisting}[language = MATLAB]
%%%% RESULTS %%%%
%%%% Problem 1, from left to right seperately the five subproblems.

   0.731370251828563   0.338388347648318   4.235294117647060
   0.742984097800381   0.298791496231346   2.917647058823530
   0.745865614845695   0.288974739670143   2.658823529411765
   0.746584596788222   0.286528567896037   2.650506804994156
   0.746764254652294   0.285917779698734   2.651347163465827
   0.746809163637828   0.285765152250462   2.651563251363765
   0.746820390541618   0.285727001721098   2.651617306152097
   0.746823197246153   0.285717464659795   2.651630821903077
   0.746823898920948   0.285715080445649   2.651634200969255

   4.188790204786390  26.516335857077454
   3.665191429188093   3.249050494484663
   3.627791516645356   1.624525247242330
   3.627598733591014   1.375722517652792
   3.627598728468435   1.320311878423620
   3.627598728468438   1.306847885497493
   3.627598728468435   1.303505658497189
   3.627598728468434   1.302671579455971
   3.627598728468434   1.302463151928108

%%%% Problem 1, Convergence Rate
  4.03046235340015          4.03359818185403          5.09090909090909
  4.00777387424737          4.01311006247428          31.1208495575211
  4.00195085385496          4.00494276887683         -9.89663899154135
  4.00048814145134          4.00182407699343          3.88896592400037
  4.00012206160764          4.00066397021311          3.99757180826783
  4.00003051650742          4.00023950278055          3.99939214721477
  4.00000762991275          4.00008586382355          3.99984796675633
  4.00000191198851          4.0000306529559           3.9999619868591
  4.00000050125624          4.00001092439743          3.99999052289029

  13.9999999999996          14.3225138557185
  194.000000001564           6.5293706782172
  37633.9850803926          4.49016169188229
       -1441877.75          4.11546853397752
 -1.14285714285714          4.02844957117035
              1.75            4.007086661022
                -4          4.00177006256679
 0.0714285714285714          4.00044241647112
 -0.451612903225806          4.00011059769848

%%%% Problem 2, from left to right seperately the five subproblems
   0.747180428909510   0.284517796864425   5.490196078431374
   0.746855379790987   0.285592545759022   2.478431372549020
   0.746826120527467   0.285702487483075   2.572549019607843
   0.746824257435730   0.285713177304669   2.647734563521620
   0.746824140606985   0.285714183632966   2.651627282956385
   0.746824133299672   0.285714276434372   2.651635280663077
   0.746824132842881   0.285714284877977   2.651635324414875
   0.746824132814330   0.285714285639361   2.651635327153400
   0.746824132812546   0.285714285707600   2.651635327324647

   4.886921905584123  22.715077371485176
   3.490658503988659  -4.506711293046267
   3.615324879131111   1.083016831494885
   3.627534472572898   1.292788274456279
   3.627598726760910   1.301841665347230
   3.627598728468435   1.302359887855449
   3.627598728468436   1.302391582830418
   3.627598728468437   1.302393553108900
   3.627598728468437   1.302393676085496

%%%% Problem 2, Convergence Rate
  11.1092720530328          9.77562343915412         -32.0000000000001
  15.7046821430617          10.2847108429078          1.25180509655896
  15.9472031841694          10.6225986308251          19.3144009409767
  15.9879213455491          10.8438906725777          486.729456914035
  15.9970581429941          10.9907327344699          182.79721303094
  15.9992844977096          11.0898072161611          15.9764074627052
  15.9996267031668          11.1575624954242          15.9917093044062
  15.961271102284           11.2041889588669          15.9958933089974
  16.241935483871           11.2414959016393          15.9437830687831


             -11.2          -4.8699664917542
  10.2105263157885          26.6467544181878
  190.020196652403          23.1704833568007
  37630.0177045329          17.4700842733937
           1922502          16.3503050157955
                 1          16.0865457723695
               Inf          16.0215726745264
                 0          16.0053958936993
 -0.111111111111111         16.0011898062322


%%%% Problem 3, Result
   0.746698561877373         0.286305014314985          4.30911188004614
   0.746816175312584         0.285770662898013          2.9361014994233
   0.746823634223746         0.28571953133681           2.66343713956171
   0.746824101632734         0.285714765812704          2.65166020753164
   0.746824130863422         0.285714329177901          2.6516355141002
   0.74682413269061          0.285714289620254          2.65163533902236
   0.746824132804813         0.285714286063546          2.65163532806675
   0.746824132811951         0.285714285745407          2.65163532738174
   0.746824132812398         0.285714285717052          2.65163532733892

    4.18879020478639          21.9638384101682
    3.66519142918809          2.11092613275734
    3.62779151664536          1.3399941568105
    3.62759873359101          1.30458974504483
    3.62759872846843          1.30252868527163
    3.62759872846844          1.3024020872095
    3.62759872846844          1.30239420892519
    3.62759872846843          1.30239371706297
    3.62759872846843          1.30239368632986

%%%% Problem 3, Convergence Rate
  15.7681775070196          10.450520273571           5.03553299492387
  15.9579968367442          10.7294727865749          23.1524100814623
  15.9903519522038          10.9142103851376          476.925698121996
  15.9976380259772          11.0379368053265          141.042586250497
  15.9994128243441          11.1219835924152          15.9806530206958
  15.9992067689053          11.1797364859218          15.9934482854748
  15.9975118188604          11.2197442066707          15.9976872018253
  16.140562248996           11.2469559856441          15.9980089596814
  19.1538461538462          11.289336316182           15.8605263157895

  13.9999999999996          25.7518340097748
  194.000000001564          21.7750256959352
  37633.9850803926          17.1777704974715
  -1441877.75               16.2803421983348
  -1.14285714285714         16.0692426452644
  1.75                      16.0172585036158
  -4                        16.0043080886874
  0.0714285714285714        16.0011642810908
  -0.451612903225806        16.0005123879498
\end{lstlisting}

\solution{Discussion}{
By numerical results, we know that the convergence rate of trapezoidal rule is about 4 when $n$ become very large (except (d)), and the convergence of simpson's rule is about 16, and that of the corrected trapezoidal rule is about 16.
}

\problem{4}{Problem 5.9}
\solution{Sol}{
Using Lagrange form,
$$
p_2(x) = \frac{(x-h)(x-2h)}{2h^2}f(0) - \frac{x(x-2h)}{h^2}f(h)+\frac{x(x-h)}{2h^2}f(2h),
$$
thus
$$
\begin{aligned}
I_h &= \int_{0}^{3h}p_2(x)dx = \int_{0}^{3h}(\frac{f(0)+f(2h)-2f(h)}{2h^2})x^2 + (\frac{4f(h)-3f(0)-f(2h)}{2h})x + f(0) dx \\
&= \frac{9h}{2}(f(0)+f(2h)-2f(h)) + \frac{9h}{4}(4f(h)-3f(0)-f(2h))+3hf(0) = \frac{3}{4}f(0) + \frac{9}{4}f(2h).
\end{aligned}
$$
and from the error of Lagrange approximation, 
$$
e(x) = f(x)-p_2(x) = \frac{(x-0)(x-h)(x-2h)}{3!}f^{(3)}(\xi), ~\xi\in(0, 3h).
$$
Thus
$$
E(x) = I-I_h = \int_{0}^{3h}e(x)dx = \frac{3}{8}h^4f^{(3)}(\xi).
$$
With Taylor expansion,
$$
f^{(3)}(\xi) = f^{(3)}(0)+ f^{(4)}(\eta)\xi = f^{(3)}(0)+ f^{(4)}(\eta)\gamma h, ~\eta\in(0, \xi),
$$
where $\gamma = \frac{\xi}{h}\in(0, 3)$. Then
$$
E(x) = \frac{3}{8}h^4f^{(3)}(0)+O(h^5).
$$
}

\problem{5}{Problem 5.10}

\end{document}